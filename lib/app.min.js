var App,socket;App=Em.Application.create(),App.Request=Em.Object.extend({client:"ClientName",resource:"ResourceName",id:1}),App.requestController=Em.ArrayController.create({content:[],addRequest:function(a){var b;return b=App.Request.create({client:a.client,resource:a.resource,id:a.id}),this.pushObject(b)},addRequests:function(a){var b,c,d,e;e=[];for(c=0,d=a.length;c<d;c++)b=a[c],e.push(this.addRequest(b));return e},removeRequest:function(a){return this.removeObject(a)},removeRequestById:function(a){var b,c,d,e,f,g,h,i,j;d=[],i=this.get("content");for(e=0,g=i.length;e<g;e++)b=i[e],b.get("id")===a&&d.push(b);j=[];for(f=0,h=d.length;f<h;f++)c=d[f],j.push(this.removeRequest(c));return j},accept:function(a){return this.removeRequest(a),App.sendApproveRequest(a)},reject:function(a){return this.removeRequest(a),App.sendDenyRequest(a)},hasRequests:function(){return this.get("length")!==0}.property("@each")}),App.activeRequest=Em.Object.create({content:null,setRequest:function(a){return this.set("content",a)},client:function(){var a;a=this.get("content");if(a)return a.get("client")}.property("content.client"),resource:function(){var a;a=this.get("content");if(a)return a.get("resource")}.property("content.resource"),accept:function(){return App.requestController.accept(this.get("content"))},reject:function(){return App.requestController.reject(this.get("content"))}}),App.requestsView=Em.View.extend({didInsertElement:function(){return $("#requests-listview").listview()}}),App.RequestView=Em.View.extend({didInsertElement:function(){return $("#requests-listview").listview()},click:function(){return App.activeRequest.setRequest(this.get("content"))}}),App.ActionButton=Em.View.extend({action:null,tagName:"div",click:function(){this.get("action")==="accept"&&App.activeRequest.accept();if(this.get("action")==="reject")return App.activeRequest.reject()}}),socket=io.connect(),socket.on("new_request",function(a){return App.requestController.addRequest(a)}),socket.on("new_requests",function(a){return App.requestController.addRequests(a)}),socket.on("approve",function(a){return App.requestController.removeRequestById(a.request_id)}),socket.on("reject",function(a){return App.requestController.removeRequestById(a.request_id)}),App.sendApproveRequest=function(a){return socket.emit("approve",a.get("id"))},App.sendDenyRequest=function(a){return socket.emit("reject",a.get("id"))}